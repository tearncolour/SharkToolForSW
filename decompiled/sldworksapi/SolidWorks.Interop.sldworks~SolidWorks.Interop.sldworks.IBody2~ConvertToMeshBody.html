<html xmlns:mshelp="http://msdn.microsoft.com/mshelp">
<head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
    <meta content="history" name="save">
    <meta content="Innovasys Document! X (http://www.innovasys.com)" name="GENERATOR">
    <title>ConvertToMeshBody Method (IBody2)</title>
    <link href="stylesheets/dotnet2005.css" type="text/css" rel="stylesheet">
    <script src="script/dotnet2005.js" type="text/javascript">
</script><xml>
<MSHelp:Keyword Index="F" Term="SolidWorks.Interop.sldworks.IBody2.ConvertToMeshBody" />
<MSHelp:Attr Name="DevLang" Value="CSharp" />
<MSHelp:Attr Name="DevLang" Value="VB" />
<MSHelp:Attr Name="DevLang" Value="JScript" />
<MSHelp:Attr Name="TopicType" Value="kbSyntax"/>
<MSHelp:Attr Name="LinkGroup" Value="Help"/>
<MSHelp:Attr Name="Locale" Value="kbEnglish"/>
<MSHelp:Attr Name="HelpPriority" Value="1"/>
</xml>

    
    <script src="script/hs-expandcollapse.js" type="text/javascript"></script>
    <script src="script/hs-enlargeimage.js" type="text/javascript"></script>
    <script src="script/swfobject.js" type="text/javascript"></script>
    <script src="script/hs-common.js" type="text/javascript"></script>
    <script src="script/hs-heading-expandcollapse.js" type="text/javascript"></script>
    <script src="script/hs-tabstrip.js" type="text/javascript"></script>
</head>

<body id="dxBody" topmargin="0">
    <form>
        <input class="userDataStyle" id="userDataCache" type="hidden" name="userDataCache"> <input id="hiddenScrollOffset" type="hidden" name=
        "hiddenScrollOffset"> <img id="collapseImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="dotnetimages/collapse.gif"> <img id="expandImage"
        style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="dotnetimages/expand.gif"> <img id="collapseAllImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px"
        src="dotnetimages/collapse.gif"> <img id="expandAllImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="dotnetimages/expand.gif"> <img id=
        "dropDownImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="dotnetimages/drpdown.gif"> <img id="dropDownHoverImage" style=
        "DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="dotnetimages/drpdown_orange.gif"> <img id="copyImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src=
        "dotnetimages/copycode.gif"> <img id="copyHoverImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="dotnetimages/copycodeHighlight.gif"> 
        
    </form>

    <div id="pagetop">
        

        <table id="pagetoptable1" width="100%">
            <tbody>
                <tr id="pagetoptable1row1">
                    <td align="left"><span id="projecttitle">SOLIDWORKS API Help</span></td>

                    <td align="right"><span id="feedbacklink"><a href="mailto:apihelp.feedback@3ds.com?subject=Documentation Feedback: SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IBody2~ConvertToMeshBody.html">Send comments</a> on this topic.</span></td>
                </tr>

                <tr id="pagetoptable1row2">
                    <td align="left" colspan="2"><span id="pagetitle">ConvertToMeshBody Method (IBody2)</span></td>
                </tr>

                <tr id="pagetoptable1row3">
                    <td colspan="2"><a onclick="javascript:openSectionById('seeAlsoSectionHeader');" href="#seealsobookmark">
                    See Also</a>&nbsp; 
                    </td>
                </tr>
            </tbody>
        </table>

        <table id="pagetoptable2" cellspacing="0" cellpadding="0" width="100%">
            <tbody>
                <tr>
                    <td><span id="toggleExpandedAll"><img class="toggleAll" id="toggleExpandedAllImage" src="dotnetimages/collapse.gif"> <label id=
                    "collapseAllLabel" style="DISPLAY: none" for="toggleExpandedAllImage">Collapse All</label> <label id="expandAllLabel" style="DISPLAY: none" for="toggleExpandedAllImage">
                    Expand All</label></span> <span id="languageFilterToolTip"
                    onmouseover='document.getElementById("languageFilterImage").src=document.getElementById("dropDownHoverImage").src;' style="CURSOR: default"
                    onfocusout='document.getElementById("languageFilterImage").src=document.getElementById("dropDownImage").src;' onclick=
                    "showBox('dxlanguagemenu',event,document.getElementById('languageFilterImage'))" onfocusin=
                    'document.getElementById("languageFilterImage").src=document.getElementById("dropDownHoverImage").src;' onmouseout=
                    'document.getElementById("languageFilterImage").src=document.getElementById("dropDownImage").src;'><img id="languageFilterImage" src=
                    "dotnetimages/drpdown.gif"> <label id="showAllLabel" style="DISPLAY: none" for="languageFilterImage">
                    Language Filter: All</label> <label id="multipleLabel" style=
                    "DISPLAY: none" for="languageFilterImage">Language Filter: Multiple</label> 
                    
<label id="VBLabel" for="languageFilterImage" style="display: none;">Language Filter: Visual Basic (Declaration)</label>
<label id="VBUsageLabel" for="languageFilterImage" style="display: none;">Language Filter: Visual Basic (Usage)</label>
<label id="CSLabel" for="languageFilterImage" style="display: none;">Language Filter: C#</label>
<label id="CPP2005Label" for="languageFilterImage" style="display: none;">Language Filter: C++/CLI</label>
</span></td>
                </tr>
            </tbody>
        </table><table width="100%" id="pagetopbreadcrumbs" cellspacing="0" cellpadding="0"><tr><td>
<a href="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks_namespace.html">SolidWorks.Interop.sldworks Namespace</a>
 > <a href="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IBody2.html">IBody2 Interface</a>
 : ConvertToMeshBody Method (IBody2)</td></tr></table>

        <div class="dxpopupbubble" id="dxlanguagemenu">
            
<input id="VBCheckbox" type="checkbox" name="languageFilter" onClick="setLanguage(this)" />
<label class="languageFilter" for="VBCheckbox">
Visual Basic (Declaration)
</label>
<br /><input id="VBUsageCheckbox" type="checkbox" name="languageFilter" onClick="setLanguage(this)" />
<label class="languageFilter" for="VBUsageCheckbox">
Visual Basic (Usage)
</label>
<br /><input id="CSCheckbox" type="checkbox" name="languageFilter" onClick="setLanguage(this)" />
<label class="languageFilter" for="CSCheckbox">
C#
</label>
<br /><input id="CPP2005Checkbox" type="checkbox" name="languageFilter" onClick="setLanguage(this)" />
<label class="languageFilter" for="CPP2005Checkbox">
C++/CLI
</label>

        </div>
<div id="GroupFacetsIntoFaces_box" class="dxpopupbubble">
<DL><DT class="popupbubble"><I>GroupFacetsIntoFaces</I></DT>
<DD class="popupbubble">True to group facets into multiple faces, false to convert the mesh into a single face; valid only for graphics bodies</DD></DL>
</div>
<div id="KeepOriginalBody_box" class="dxpopupbubble">
<DL><DT class="popupbubble"><I>KeepOriginalBody</I></DT>
<DD class="popupbubble">True to maintain a reference copy of the original solid or surface body; false to not</DD></DL>
</div>
<div id="HideOriginalBody_box" class="dxpopupbubble">
<DL><DT class="popupbubble"><I>HideOriginalBody</I></DT>
<DD class="popupbubble">True to hide the original body, false to not; valid only of KeepOriginalBody is true</DD></DL>
</div>
<div id="MeshRefinement_box" class="dxpopupbubble">
<DL><DT class="popupbubble"><I>MeshRefinement</I></DT>
<DD class="popupbubble">0.0 (larger&nbsp;mesh facets)&nbsp;&lt;= Percent&nbsp;refinement &lt;= 100.0 (smaller mesh facets); valid only if AdvancedMeshRefinement is false</DD></DL>
</div>
<div id="AdvancedMeshRefinement_box" class="dxpopupbubble">
<DL><DT class="popupbubble"><I>AdvancedMeshRefinement</I></DT>
<DD class="popupbubble">True to specify maximum distance and angle, false to not</DD></DL>
</div>
<div id="MaximumDistance_box" class="dxpopupbubble">
<DL><DT class="popupbubble"><I>MaximumDistance</I></DT>
<DD class="popupbubble">Maximum distance deviation in meters</DD></DL>
</div>
<div id="MaximumAngle_box" class="dxpopupbubble">
<DL><DT class="popupbubble"><I>MaximumAngle</I></DT>
<DD class="popupbubble">Maximum angle deviation in radians</DD></DL>
</div>
<div id="DefineMaxElementSize_box" class="dxpopupbubble">
<DL><DT class="popupbubble"><I>DefineMaxElementSize</I></DT>
<DD class="popupbubble">True to specify the maximum length of the fins, false to not</DD></DL>
</div>
<div id="ElementSize_box" class="dxpopupbubble">
<DL><DT class="popupbubble"><I>ElementSize</I></DT>
<DD class="popupbubble">Length of fins&nbsp;in meters; valid only if DefineMaxElementSize is true</DD></DL>
</div>
<div id="ErrorCode_box" class="dxpopupbubble">
<DL><DT class="popupbubble"><I>ErrorCode</I></DT>
<DD class="popupbubble">0 if successful, -1 if errors</DD></DL>
</div>

    </div>

    <div id="pagebody" valign="bottom">
        <a name="topBookmark"></a>

        <div id="mainbody">
            <div class="saveHistory" id="allHistory" onsave="saveAll()" onload="loadAll()"></div>
             Converts a solid body to a mesh BREP (boundary representation) body. 
             
             
            <h1 class="heading"><span class="expandcollapse" tabindex="0"><img id="syntaxToggle" class="toggle" name="toggleSwitch" src="dotnetimages/collapse.gif"></img>.NET Syntax</span></h1><div id="syntaxSection" class="section" name="collapseableSection"><DIV class=LanguageSpecific id=Syntax_VB><table class="syntaxtable" width="100%" cellpadding="0" cellspacing="0"><tr><th>Visual Basic (Declaration)</th><th>&nbsp;</th></tr><tr><td colspan="2"><pre>Function ConvertToMeshBody( _
&nbsp;&nbsp;&nbsp;ByVal <i><a class="parameter" id="GroupFacetsIntoFaces" href="#" onclick="javascript:showParamBox(event);">GroupFacetsIntoFaces</a></i> As System.Boolean, _
&nbsp;&nbsp;&nbsp;ByVal <i><a class="parameter" id="KeepOriginalBody" href="#" onclick="javascript:showParamBox(event);">KeepOriginalBody</a></i> As System.Boolean, _
&nbsp;&nbsp;&nbsp;ByVal <i><a class="parameter" id="HideOriginalBody" href="#" onclick="javascript:showParamBox(event);">HideOriginalBody</a></i> As System.Boolean, _
&nbsp;&nbsp;&nbsp;ByVal <i><a class="parameter" id="MeshRefinement" href="#" onclick="javascript:showParamBox(event);">MeshRefinement</a></i> As System.Double, _
&nbsp;&nbsp;&nbsp;ByVal <i><a class="parameter" id="AdvancedMeshRefinement" href="#" onclick="javascript:showParamBox(event);">AdvancedMeshRefinement</a></i> As System.Boolean, _
&nbsp;&nbsp;&nbsp;ByVal <i><a class="parameter" id="MaximumDistance" href="#" onclick="javascript:showParamBox(event);">MaximumDistance</a></i> As System.Double, _
&nbsp;&nbsp;&nbsp;ByVal <i><a class="parameter" id="MaximumAngle" href="#" onclick="javascript:showParamBox(event);">MaximumAngle</a></i> As System.Double, _
&nbsp;&nbsp;&nbsp;ByVal <i><a class="parameter" id="DefineMaxElementSize" href="#" onclick="javascript:showParamBox(event);">DefineMaxElementSize</a></i> As System.Boolean, _
&nbsp;&nbsp;&nbsp;ByVal <i><a class="parameter" id="ElementSize" href="#" onclick="javascript:showParamBox(event);">ElementSize</a></i> As System.Double, _
&nbsp;&nbsp;&nbsp;ByRef <i><a class="parameter" id="ErrorCode" href="#" onclick="javascript:showParamBox(event);">ErrorCode</a></i> As System.Integer _
) As System.Object</pre></tr></table></div>
<DIV class=LanguageSpecific id=Syntax_VBUsage><table class="syntaxtable" width="100%" cellpadding="0" cellspacing="0"><tr><th>Visual Basic (Usage)</th><th><span class="copyCode" onclick="copyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="changeCopyCodeIcon(this,true)" onfocusin="changeCopyCodeIcon(this,true)" onmouseout="changeCopyCodeIcon(this,false)" onfocusout="changeCopyCodeIcon(this,false)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="dotnetimages/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>Dim instance As <a href="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IBody2.html">IBody2</a>
Dim GroupFacetsIntoFaces As System.Boolean
Dim KeepOriginalBody As System.Boolean
Dim HideOriginalBody As System.Boolean
Dim MeshRefinement As System.Double
Dim AdvancedMeshRefinement As System.Boolean
Dim MaximumDistance As System.Double
Dim MaximumAngle As System.Double
Dim DefineMaxElementSize As System.Boolean
Dim ElementSize As System.Double
Dim ErrorCode As System.Integer
Dim value As System.Object
&nbsp;
value = instance.ConvertToMeshBody(GroupFacetsIntoFaces, KeepOriginalBody, HideOriginalBody, MeshRefinement, AdvancedMeshRefinement, MaximumDistance, MaximumAngle, DefineMaxElementSize, ElementSize, ErrorCode)</pre></tr></table></div>
<DIV class=LanguageSpecific id=Syntax_CS><table class="syntaxtable" width="100%" cellpadding="0" cellspacing="0"><tr><th>C#</th><th>&nbsp;</th></tr><tr><td colspan="2"><pre>System.object ConvertToMeshBody( 
&nbsp;&nbsp;&nbsp;System.bool <i><a class="parameter" id="GroupFacetsIntoFaces" href="#" onclick="javascript:showParamBox(event);">GroupFacetsIntoFaces</a></i>,
&nbsp;&nbsp;&nbsp;System.bool <i><a class="parameter" id="KeepOriginalBody" href="#" onclick="javascript:showParamBox(event);">KeepOriginalBody</a></i>,
&nbsp;&nbsp;&nbsp;System.bool <i><a class="parameter" id="HideOriginalBody" href="#" onclick="javascript:showParamBox(event);">HideOriginalBody</a></i>,
&nbsp;&nbsp;&nbsp;System.double <i><a class="parameter" id="MeshRefinement" href="#" onclick="javascript:showParamBox(event);">MeshRefinement</a></i>,
&nbsp;&nbsp;&nbsp;System.bool <i><a class="parameter" id="AdvancedMeshRefinement" href="#" onclick="javascript:showParamBox(event);">AdvancedMeshRefinement</a></i>,
&nbsp;&nbsp;&nbsp;System.double <i><a class="parameter" id="MaximumDistance" href="#" onclick="javascript:showParamBox(event);">MaximumDistance</a></i>,
&nbsp;&nbsp;&nbsp;System.double <i><a class="parameter" id="MaximumAngle" href="#" onclick="javascript:showParamBox(event);">MaximumAngle</a></i>,
&nbsp;&nbsp;&nbsp;System.bool <i><a class="parameter" id="DefineMaxElementSize" href="#" onclick="javascript:showParamBox(event);">DefineMaxElementSize</a></i>,
&nbsp;&nbsp;&nbsp;System.double <i><a class="parameter" id="ElementSize" href="#" onclick="javascript:showParamBox(event);">ElementSize</a></i>,
&nbsp;&nbsp;&nbsp;out System.int <i><a class="parameter" id="ErrorCode" href="#" onclick="javascript:showParamBox(event);">ErrorCode</a></i>
)</pre></tr></table></div>
<DIV class=LanguageSpecific id=Syntax_CPP2005><table class="syntaxtable" width="100%" cellpadding="0" cellspacing="0"><tr><th>C++/CLI</th><th>&nbsp;</th></tr><tr><td colspan="2"><pre>System.Object^ ConvertToMeshBody( 
&&nbsp;&nbsp;&nbsp;System.bool <i><a class="parameter" id="GroupFacetsIntoFaces" href="#" onclick="javascript:showParamBox(event);">GroupFacetsIntoFaces</a></i>,
&&nbsp;&nbsp;&nbsp;System.bool <i><a class="parameter" id="KeepOriginalBody" href="#" onclick="javascript:showParamBox(event);">KeepOriginalBody</a></i>,
&&nbsp;&nbsp;&nbsp;System.bool <i><a class="parameter" id="HideOriginalBody" href="#" onclick="javascript:showParamBox(event);">HideOriginalBody</a></i>,
&&nbsp;&nbsp;&nbsp;System.double <i><a class="parameter" id="MeshRefinement" href="#" onclick="javascript:showParamBox(event);">MeshRefinement</a></i>,
&&nbsp;&nbsp;&nbsp;System.bool <i><a class="parameter" id="AdvancedMeshRefinement" href="#" onclick="javascript:showParamBox(event);">AdvancedMeshRefinement</a></i>,
&&nbsp;&nbsp;&nbsp;System.double <i><a class="parameter" id="MaximumDistance" href="#" onclick="javascript:showParamBox(event);">MaximumDistance</a></i>,
&&nbsp;&nbsp;&nbsp;System.double <i><a class="parameter" id="MaximumAngle" href="#" onclick="javascript:showParamBox(event);">MaximumAngle</a></i>,
&&nbsp;&nbsp;&nbsp;System.bool <i><a class="parameter" id="DefineMaxElementSize" href="#" onclick="javascript:showParamBox(event);">DefineMaxElementSize</a></i>,
&&nbsp;&nbsp;&nbsp;System.double <i><a class="parameter" id="ElementSize" href="#" onclick="javascript:showParamBox(event);">ElementSize</a></i>,
&&nbsp;&nbsp;&nbsp;[Out] System.int <i><a class="parameter" id="ErrorCode" href="#" onclick="javascript:showParamBox(event);">ErrorCode</a></i>
) </pre></tr></table></div>
 
            <b><font color=RED>NOTE:</font></b> See <a href=DifferencesBetweenUnManagedAndCPPCLI.htm>Differences Between Unmanaged C++ and C++/CLI Code</a>.<h4 class=dxh4>Parameters</h4><DL><DT><I>GroupFacetsIntoFaces</I></DT>
<DD>True to group facets into multiple faces, false to convert the mesh into a single face; valid only for graphics bodies</DD><DT><I>KeepOriginalBody</I></DT>
<DD>True to maintain a reference copy of the original solid or surface body; false to not</DD><DT><I>HideOriginalBody</I></DT>
<DD>True to hide the original body, false to not; valid only of KeepOriginalBody is true</DD><DT><I>MeshRefinement</I></DT>
<DD>0.0 (larger&nbsp;mesh facets)&nbsp;&lt;= Percent&nbsp;refinement &lt;= 100.0 (smaller mesh facets); valid only if AdvancedMeshRefinement is false</DD><DT><I>AdvancedMeshRefinement</I></DT>
<DD>True to specify maximum distance and angle, false to not</DD><DT><I>MaximumDistance</I></DT>
<DD>Maximum distance deviation in meters</DD><DT><I>MaximumAngle</I></DT>
<DD>Maximum angle deviation in radians</DD><DT><I>DefineMaxElementSize</I></DT>
<DD>True to specify the maximum length of the fins, false to not</DD><DT><I>ElementSize</I></DT>
<DD>Length of fins&nbsp;in meters; valid only if DefineMaxElementSize is true</DD><DT><I>ErrorCode</I></DT>
<DD>0 if successful, -1 if errors</DD></DL> 
             
            <h4 class=dxh4>Return Value</h4><P>Array of:</P>
<P>One&nbsp;<A href="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IBody2.html">body</A> (if this is a solid body)</P>
<P>&nbsp;- or -</P>
<P>Multiple surface bodies (if this is a graphics body)</P></div> 
            <h1 class="heading"><span class="expandcollapse" tabindex="0"><img id="visualbasic6syntaxToggle" class="toggle" name="toggleSwitch" src="dotnetimages/collapse.gif"></img>Visual Basic for Applications (VBA) Syntax</span></h1><div id="visualbasic6syntaxSection" class="section" name="collapseableSection">See <A href="ms-its:sldworksapivb6.chm::/sldworks~Body2~ConvertToMeshBody.html">Body2::ConvertToMeshBody</A>.</div> 
             
             <a name="exampleBookmark"></a>
            <h1 class="heading"><span class="expandcollapse" tabindex="0"><img id="exampleToggle" class="toggle" name="toggleSwitch" src="dotnetimages/collapse.gif"></img>Example</span></h1><div id="exampleSection" class="section" name="collapseableSection"><P>'VBA</P>
<P>'===============================================================<BR>'Preconditions:<BR>'1. Open a part that contains a solid body, a graphics body, or a mesh body.<BR>'2. If you open a solid body, this macro converts it to a mesh body.<BR>'3. If you open a graphics body that is meshed or you open a mesh body, multi-select the mesh facets that<BR>'&nbsp;&nbsp; can be used to create a plane, cylinder, cone, or sphere.<BR>'4. Open an Immediate window.<BR>'<BR>'Postconditions:<BR>'1. Inspect the Immediate window.<BR>'2. If a solid body was opened, <STRONG>Body-Convert to Mesh Body</STRONG><EM>X</EM> is created in the FeatureManager design tree.<BR>'3. If a graphics body or a mesh body was opened and you selected facets,<BR>'&nbsp;&nbsp; this macro creates a <STRONG>Surface-From-Mesh</STRONG><EM>X</EM> feature from the selected mesh facets<BR>'&nbsp;&nbsp; using the specified facet tolerance and extend surface size.<BR>'&nbsp;&nbsp; If ErrorCodeSurfaceFromMesh is -1, then select more mesh facets and/or<BR>'&nbsp;&nbsp; change the IGraphicsBody/IMeshBody::SurfaceFromMesh parameters (SurfaceType/FacetTolerance/ExtendSurfaceSize).<BR>'===============================================================<BR>Option Explicit</P>
<P>Sub main()<BR>&nbsp;&nbsp;&nbsp; Dim swApp As SldWorks.SldWorks<BR>&nbsp;&nbsp;&nbsp; Dim swModelDoc As ModelDoc2<BR>&nbsp;&nbsp;&nbsp; Dim swFeatMgr As FeatureManager<BR>&nbsp;&nbsp;&nbsp; Dim swSelMgr As SelectionMgr<BR>&nbsp;&nbsp;&nbsp; Dim swSelData As SelectData</P>
<P>&nbsp;&nbsp;&nbsp; Dim boolstatus As Boolean<BR>&nbsp;&nbsp;&nbsp; Dim longstatus As Long, longwarnings As Long</P>
<P>&nbsp;&nbsp;&nbsp; Set swApp = Application.SldWorks<BR>&nbsp;&nbsp;&nbsp; Set swModelDoc = swApp.ActiveDoc<BR>&nbsp;&nbsp;&nbsp; Set swSelMgr = swModelDoc.SelectionManager<BR>&nbsp;&nbsp;&nbsp; Set swSelData = swSelMgr.CreateSelectData<BR>&nbsp;&nbsp;&nbsp; swSelData.Mark = 1<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; Dim swPartDoc As PartDoc<BR>&nbsp;&nbsp;&nbsp; Set swPartDoc = swModelDoc<BR>&nbsp;&nbsp;&nbsp; Dim vAllBodies As Variant<BR>&nbsp;&nbsp;&nbsp; vAllBodies = swPartDoc.GetBodies2(swAllBodies, False)<BR>&nbsp;&nbsp;&nbsp; Dim swGenericBody As Body2<BR>&nbsp;&nbsp;&nbsp; Dim lBodyType As Long<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; Dim swBody As Body2<BR>&nbsp;&nbsp;&nbsp; Dim swGraphicsBody As GraphicsBody<BR>&nbsp;&nbsp;&nbsp; Dim swMeshBody As MeshBody<BR>&nbsp;&nbsp;&nbsp; Dim swBodyFeat As Feature</P>
<P>&nbsp;&nbsp;&nbsp; 'Use first body that is Solid, Mesh or Graphics Body<BR>&nbsp;&nbsp;&nbsp; Set swBody = Nothing<BR>&nbsp;&nbsp;&nbsp; Set swMeshBody = Nothing<BR>&nbsp;&nbsp;&nbsp; Set swGraphicsBody = Nothing<BR>&nbsp;&nbsp;&nbsp; Dim i As Integer<BR>&nbsp;&nbsp;&nbsp; For i = 0 To UBound(vAllBodies)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set swGenericBody = vAllBodies(i)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lBodyType = swGenericBody.GetType<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If lBodyType = swBodyType_e.swSolidBody Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print "Body type is swSolidBody"<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set swBody = swGenericBody<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Exit For<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ElseIf lBodyType = swBodyType_e.swMeshBody Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print "Body type is swMeshBody"<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set swBody = swGenericBody<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set swMeshBody = swBody.GetMeshBody<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Exit For<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ElseIf lBodyType = swBodyType_e.swGraphicsBody Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print "Body type is swGraphicsBody"<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set swBody = swGenericBody<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set swGraphicsBody = swBody.GetGraphicsBody<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Exit For<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<BR>&nbsp;&nbsp;&nbsp; Next i<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; Dim lSelObjType As Long<BR>&nbsp;&nbsp;&nbsp; Dim lSelObjCount As Long<BR>&nbsp;&nbsp;&nbsp; lSelObjType = swSelMgr.GetSelectedObjectType3(1, -1)<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; If lSelObjType = swSelNOTHING Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print "Nothing is selected"<BR>&nbsp;&nbsp;&nbsp; ElseIf lSelObjType = swSelSOLIDBODIES Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print "swSolidBody is selected"<BR>&nbsp;&nbsp;&nbsp; ElseIf lSelObjType = swSelGRAPHICSBODY Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print "swGraphicsBody is selected"<BR>&nbsp;&nbsp;&nbsp; ElseIf lSelObjType = swSelMESHSOLIDBODIES Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print "swMeshBody is selected"<BR>&nbsp;&nbsp;&nbsp; ElseIf lSelObjType = swSelFACETS Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print "swSelFACETS is selected"<BR>&nbsp;&nbsp;&nbsp; Else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print "Nothing interesting is selected"<BR>&nbsp;&nbsp;&nbsp; End If</P>
<P>&nbsp;&nbsp;&nbsp; Dim swSurfaceBody As Body2<BR>&nbsp;&nbsp;&nbsp; Dim SurfaceType As Long<BR>&nbsp;&nbsp;&nbsp; Dim FacetTolerance As Double<BR>&nbsp;&nbsp;&nbsp; Dim ExtendSurfaceSize As Double<BR>&nbsp;&nbsp;&nbsp; Dim ErrorCodeSurfaceFromMesh As Long<BR>&nbsp;&nbsp;&nbsp; Set swSurfaceBody = Nothing<BR>&nbsp;&nbsp;&nbsp; SurfaceType = swSurfaceTypes_e.PLANE_TYPE<BR>&nbsp;&nbsp;&nbsp; FacetTolerance = 0<BR>&nbsp;&nbsp;&nbsp; ExtendSurfaceSize = 0.023<BR>&nbsp;&nbsp;&nbsp; ErrorCodeSurfaceFromMesh = 0</P>
<P>&nbsp;&nbsp;&nbsp; If Not swGraphicsBody Is Nothing Then&nbsp; 'And lSelObjType = swSelFACETS<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print "Testing GraphicsBody.SurfaceFromMesh"<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set swSurfaceBody = swGraphicsBody.<STRONG>SurfaceFromMesh</STRONG>(SurfaceType, FacetTolerance, ExtendSurfaceSize, ErrorCodeSurfaceFromMesh)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print "ErrorCodeSurfaceFromMesh = " &amp; ErrorCodeSurfaceFromMesh<BR>&nbsp;&nbsp;&nbsp; ElseIf Not swMeshBody Is Nothing Then 'And lSelObjType = swSelFACETS<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print "Testing MeshBody.SurfaceFromMesh"<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set swSurfaceBody = swMeshBody.<STRONG>SurfaceFromMesh</STRONG>(SurfaceType, FacetTolerance, ExtendSurfaceSize, ErrorCodeSurfaceFromMesh)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print "ErrorCodeSurfaceFromMesh = " &amp; ErrorCodeSurfaceFromMesh<BR>&nbsp;&nbsp;&nbsp; ElseIf Not swBody Is Nothing Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print "Testing ConvertToMeshBody"<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; swBody.Select2 False, swSelData<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim outBodiesArray As Variant<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim GroupFacetsIntoFaces As Boolean<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim KeepOriginalBody As Boolean<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim HideOriginalBody As Boolean<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim MeshRefinement As Double<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim AdvancedMeshRefinement As Boolean<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim MaximumDistance As Double<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim MaximumAngle As Double<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim DefineMaxElementSize As Boolean<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim ElementSize As Double<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim ErrorCode As Long<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GroupFacetsIntoFaces = False<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; KeepOriginalBody = False<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; HideOriginalBody = False<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MeshRefinement = 0.005<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AdvancedMeshRefinement = False<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MaximumDistance = 0.01<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MaximumAngle = 0.05<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DefineMaxElementSize = False<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ElementSize = 0.01<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ErrorCode = -1<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; outBodiesArray = swBody.<STRONG>ConvertToMeshBody</STRONG>(GroupFacetsIntoFaces, KeepOriginalBody, HideOriginalBody, MeshRefinement, AdvancedMeshRefinement, MaximumDistance, MaximumAngle, DefineMaxElementSize, ElementSize, ErrorCode)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If IsEmpty(outBodiesArray) Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print "outBodiesArray is Empty"<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim lCount As Long<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lCount = UBound(outBodiesArray) - LBound(outBodiesArray) + 1<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If lCount &gt; 0 Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print "outBodiesArray has " &amp; lCount &amp; " elements."<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim swNewBody As Body2<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set swNewBody = outBodiesArray(0)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Not swNewBody Is Nothing Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print "Returned a Body"<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print "No Body Returned"<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print "outBodiesArray has no elements."<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print "ErrorCodeConvertToMesh = " &amp; ErrorCode<BR>&nbsp;&nbsp;&nbsp; End If<BR>&nbsp;&nbsp;&nbsp; <BR>End Sub</P> 
            </div> 
            
            <h1 class="heading"><span class="expandcollapse" tabindex="0"><img id="remarksToggle" class="toggle" name="toggleSwitch" src="dotnetimages/collapse.gif"></img>Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection"><P>Call this method for each body you want to convert.</P>
<P>This&nbsp;method creates <STRONG>Body-Convert to Mesh Body</STRONG> in the FeatureManager design tree.</P>
<P>This method is analogous to the <STRONG>SOLIDWORKS menu Insert &gt; Mesh &gt; Convert To Mesh Body</STRONG>. For more information, see the <STRONG>SOLIDWORKS user-interface help &gt; Parts and Features &gt; Graphics Mesh and Mesh BREP Bodies &gt; Converting Solid, Surface or Graphics Bodies to Mesh</STRONG> topic.</P></div>&nbsp;
            <a name="seealsobookmark"></a>
            <h1 class="heading"><span class="expandcollapse" tabindex="0"><img id="seealsoToggle" class="toggle" name="toggleSwitch" src="dotnetimages/collapse.gif"></img>See Also</span></h1><div id="seealsoSection" class="section" name="collapseableSection"><h4 class="dxh4"></h4><a href="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IBody2.html">IBody2 Interface</a>
<br/><a href="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IBody2_members.html">IBody2 Members</a>
</p>
</div> 
            <h1 class="heading"><span class="expandcollapse" tabindex="0"><img id="availabilityToggle" class="toggle" name="toggleSwitch" src="dotnetimages/collapse.gif"></img>Availability</span></h1><div id="availabilitySection" class="section" name="collapseableSection">SOLIDWORKS 2023 FCS, Revision Number 31</div>
        </div>

        <div id="pagefooter"></div>
    </div>
</body>
</html>