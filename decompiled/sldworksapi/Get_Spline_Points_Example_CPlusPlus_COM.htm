<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>Get Spline Points Example (C++)</title>

<!--(Meta)==========================================================-->

<meta http-equiv=content-type content="text/html; charset=windows-1252">
<meta name=MS-HKWD content="C++ examples, IDispatch">
<meta name=MS-HKWD content="C++ examples, splines">
<meta name=MS-HKWD content="C++ examples, QueryInterface">
<meta name=MS-HKWD content="C++ examples, ISafeArrayUtility">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=5536>
<meta name=layout-width content=630>


<!--(Links)=========================================================-->

<link rel="StyleSheet" href="./APIHelp.css">



<style type="text/css">
.auto-style1 {
	font-family: "Courier New", Courier, monospace;
	font-size: 10pt;
}
.auto-style2 {
	color: #008000;
}
</style>



</head>

<!--(Body)==========================================================-->


<body>

<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API Help</span></h1>

<h1>Get Spline Points Example (C++)</h1>

<p>This example shows how to get the points on a spline.</p>
<p><span class="auto-style2">/</span><span class="auto-style1"><span class="auto-style2">/-------------------------------------------------------</span><br class="auto-style2">
<span class="auto-style2">// Preconditions: </span><br class="auto-style2">
<span class="auto-style2">// 1. Start up SOLIDWORKS and open a new part 
document.</span><br class="auto-style2"><span class="auto-style2">// 2. Sketch a 
spline.</span><br class="auto-style2"><span class="auto-style2">// 3. Select the 
Sketch1 feature of the spline in the FeatureManager design tree. </span>
<br class="auto-style2"><span class="auto-style2">//</span><br class="auto-style2">
<span class="auto-style2">// NOTE: Do not select the spline in the graphics 
area. This </span><br class="auto-style2"><span class="auto-style2">// causes an 
assert, which results in you having to abort and</span><br class="auto-style2">
<span class="auto-style2">// terminate the debug session.</span><br class="auto-style2">
<span class="auto-style2">//</span><br class="auto-style2">
<span class="auto-style2">// 4. Start Microsoft Visual Studio 2019 or later.</span><br class="auto-style2">
<span class="auto-style2">//&nbsp;&nbsp;&nbsp; a. Click <strong>File &gt; New &gt; 
Project &gt; (C++ Windows) Console App</strong>.</span><br class="auto-style2">
<span class="auto-style2">//&nbsp;&nbsp;&nbsp; b. Click <strong>Next</strong>.</span><br class="auto-style2">
<span class="auto-style2">//&nbsp;&nbsp;&nbsp; c. Type the name of your project 
in <strong>Project Name</strong>.</span><br class="auto-style2">
<span class="auto-style2">//&nbsp;&nbsp;&nbsp; d. Click <strong>Create</strong>.</span><br class="auto-style2">
<span class="auto-style2">//&nbsp;&nbsp;&nbsp; e. Right-click project, select
<strong>Add</strong>, <strong>New Item</strong>, Select <strong>ATL &gt; ATL Suppor</strong>t, 
Click <strong>Add</strong>.</span><br class="auto-style2">
<span class="auto-style2">//&nbsp;&nbsp;&nbsp; f. Click <strong>Project &gt; 
projectname Properties &gt; Configuration Properties &gt; </strong></span><strong>
<br class="auto-style2"></strong><span class="auto-style2">//<strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
C/C++</strong> and type the path to <strong>sldworks.tlb</strong> and <strong>
swconst.tlb</strong>, </span><br class="auto-style2"><span class="auto-style2">
//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; typically <strong>C:\Program 
Files\SOLIDWORKS Corp\SOLIDWORK</strong>S, </span><br class="auto-style2">
<span class="auto-style2">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; in Additional 
Include Directories.</span><br class="auto-style2"><span class="auto-style2">//&nbsp;&nbsp;&nbsp; 
g. Click <strong>Apply</strong> or <strong>OK</strong>.</span><br class="auto-style2">
<span class="auto-style2">// 5. Replace the code in the code<strong> </strong>
window with<strong> This code.</strong></span><strong><br class="auto-style2">
</strong><span class="auto-style2">//<strong> </strong>6.<strong> </strong>Click<strong> 
Debug &gt; Start Debugging</strong>. </span><br class="auto-style2">
<span class="auto-style2">//</span><br class="auto-style2">
<span class="auto-style2">// Postconditions: </span><br class="auto-style2">
<span class="auto-style2">// 1. Prints to the Output Window the number of spline 
points followed by </span><br class="auto-style2"><span class="auto-style2">//&nbsp;&nbsp;&nbsp; 
the x, y, z values of each point in the spline.</span><br class="auto-style2">
<span class="auto-style2">// 2. Examine the Output Window.</span><br class="auto-style2">
<span class="auto-style2">
//-------------------------------------------------------</span><br><br>
<span class="auto-style2">//<strong>This code</strong></span> <br>#include 
&quot;framework.h&quot;<br>#import &quot;sldworks.tlb&quot; raw_interfaces_only, raw_native_types, 
no_namespace, named_guids // SOLIDWORKS type library<br>#import &quot;swconst.tlb&quot; 
raw_interfaces_only, raw_native_types, no_namespace, named_guids // SOLIDWORKS 
constants type library<br>#include &lt;iostream&gt;<br>#include &lt;sstream&gt;<br><br>int 
_tmain(int argc, _TCHAR* argv[])<br>{<br><span class="auto-style2">// Initialize 
COM</span><br class="auto-style2"><span class="auto-style2">// Do this before 
using ATL smart pointers so that </span><br class="auto-style2">
<span class="auto-style2">// COM is available</span><br>::CoInitialize(NULL);<br>
<br>{<br><span class="auto-style2">//Use ATL smart pointers</span><br>
CComPtr&lt;ISldWorks&gt; pSwApp;<br>if 
(pSwApp.CoCreateInstance(L&quot;Sldworks.Application&quot;, NULL, CLSCTX_LOCAL_SERVER) != 
S_OK) {<br>return(0);<br>}<br><br>CComPtr&lt;IModelDoc2&gt; pSwModel;<br>
pSwApp-&gt;get_IActiveDoc2(&amp;pSwModel);<br><br><span class="auto-style2">//Get the 
selected sketch feature</span><br>CComPtr&lt;ISelectionMgr&gt; pSwSelMgr;<br>
pSwModel-&gt;get_ISelectionManager(&amp;pSwSelMgr);<br>IDispatch* pDisp;<br>
pSwSelMgr-&gt;GetSelectedObject6(1, -1, &amp;pDisp);<br><br>CComPtr&lt;IFeature&gt; pSwFeat;<br>
if (S_OK == pDisp-&gt;QueryInterface(IID_IFeature, (void**)&amp;pSwFeat));<br>pDisp = 
NULL;<br><br>//Get the sketch feature<br>pSwFeat-&gt;GetSpecificFeature2(&amp;pDisp);<br>
CComPtr&lt;ISketch&gt; pSwSketch;<br>if (S_OK == pDisp-&gt;QueryInterface(IID_ISketch, 
(void**)&amp;pSwSketch));<br>pDisp = NULL;<br><br><span class="auto-style2">//Gets 
the spline points by interpolation </span><br>VARIANT vSplines;<br>
::VariantInit(&amp;vSplines);<br>pSwSketch-&gt;GetSplinesInterpolate(&amp;vSplines);<br>
<br>CComPtr&lt;IDispatch&gt; pDispatchSafeArray = NULL;<br>CComPtr&lt;ISafeArrayUtility&gt; 
pSwSafeArray = NULL;<br>HRESULT hres;<br>hres = 
pSwApp-&gt;GetSafeArrayUtility(&amp;pDispatchSafeArray);<br>hres = 
pDispatchSafeArray.QueryInterface&lt;ISafeArrayUtility&gt;(&amp;pSwSafeArray);<br><br>
<span class="auto-style2">//First value in vSplines array is the number of</span><br class="auto-style2">
<span class="auto-style2">//sketch (or spline) points, followed by the x, y, z</span><br class="auto-style2">
<span class="auto-style2">//coordinates of each point in the spline, so 
calculate </span><br class="auto-style2"><span class="auto-style2">//the size of 
the array </span><br>long nbrSketchPoints;<br>
pSwSketch-&gt;GetSketchPointsCount2(&amp;nbrSketchPoints);<br>long splineArraySize = 1 
+ (nbrSketchPoints * 3);<br><br><span class="auto-style2">//Print to the 
Immediate Window the</span><br class="auto-style2"><span class="auto-style2">
//number of spline points followed by the </span><br class="auto-style2">
<span class="auto-style2">//x, y, z values of each of point in the spline</span><br>
for (int idx = 0; idx &lt; splineArraySize; idx++)<br>{<br>double sketchPointValue;<br>
pSwSafeArray-&gt;GetDouble(vSplines, idx, &amp;sketchPointValue);<br>_bstr_t s;<br>s = 
(double)sketchPointValue;<br><br>OutputDebugString(s + &quot;\n&quot;);<br>}<br><br>}<br>
<br><span class="auto-style2">//Uninitialize COM</span><br>::CoUninitialize();<br>
<br>return(0);<br></span>}</p>

</body>

</html>
