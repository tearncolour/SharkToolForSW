<html xmlns:mshelp="http://msdn.microsoft.com/mshelp">
<head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
    <meta content="history" name="save">
    <meta content="Innovasys Document! X (http://www.innovasys.com)" name="GENERATOR">
    <title>IGtolFrame Interface</title>
    <link href="stylesheets/dotnet2005.css" type="text/css" rel="stylesheet">
    <script src="script/dotnet2005.js" type="text/javascript">
</script><xml>
<MSHelp:Keyword Index="F" Term="SolidWorks.Interop.sldworks.IGtolFrame" />
<MSHelp:Attr Name="DevLang" Value="CSharp" />
<MSHelp:Attr Name="DevLang" Value="VB" />
<MSHelp:Attr Name="DevLang" Value="JScript" />
<MSHelp:Attr Name="TopicType" Value="kbSyntax"/>
<MSHelp:Attr Name="LinkGroup" Value="Help"/>
<MSHelp:Attr Name="Locale" Value="kbEnglish"/>
<MSHelp:Attr Name="HelpPriority" Value="1"/>
</xml>

    
    <script src="script/hs-expandcollapse.js" type="text/javascript"></script>
    <script src="script/hs-enlargeimage.js" type="text/javascript"></script>
    <script src="script/swfobject.js" type="text/javascript"></script>
    <script src="script/hs-common.js" type="text/javascript"></script>
    <script src="script/hs-heading-expandcollapse.js" type="text/javascript"></script>
    <script src="script/hs-tabstrip.js" type="text/javascript"></script>
</head>

<body id="dxBody" topmargin="0">
    <form>
        <input class="userDataStyle" id="userDataCache" type="hidden" name="userDataCache"> <input id="hiddenScrollOffset" type="hidden" name=
        "hiddenScrollOffset"> <img id="collapseImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="dotnetimages/collapse.gif"> <img id="expandImage"
        style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="dotnetimages/expand.gif"> <img id="collapseAllImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px"
        src="dotnetimages/collapse.gif"> <img id="expandAllImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="dotnetimages/expand.gif"> <img id=
        "dropDownImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="dotnetimages/drpdown.gif"> <img id="dropDownHoverImage" style=
        "DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="dotnetimages/drpdown_orange.gif"> <img id="copyImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src=
        "dotnetimages/copycode.gif"> <img id="copyHoverImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="dotnetimages/copycodeHighlight.gif"> 
        
    </form>

    <div id="pagetop">
        

        <table id="pagetoptable1" width="100%">
            <tbody>
                <tr id="pagetoptable1row1">
                    <td align="left"><span id="projecttitle">SOLIDWORKS API Help</span></td>

                    <td align="right"><span id="feedbacklink"><a href="mailto:apihelp.feedback@3ds.com?subject=Documentation Feedback: SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IGtolFrame.html">Send comments</a> on this topic.</span></td>
                </tr>

                <tr id="pagetoptable1row2">
                    <td align="left" colspan="2"><span id="pagetitle">IGtolFrame Interface</span></td>
                </tr>

                <tr id="pagetoptable1row3">
                    <td colspan="2"><a onclick="javascript:openSectionById('seeAlsoSectionHeader');" href="#seealsobookmark">
                    See Also</a>&nbsp; 
                    <a href="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IGtolFrame_members.html">Members</a>&nbsp;&nbsp; 
                    <a href="#ExampleBookmark" onclick="javascript:openSectionById('exampleSectionHeader');">Example</a></td>
                </tr>
            </tbody>
        </table>

        <table id="pagetoptable2" cellspacing="0" cellpadding="0" width="100%">
            <tbody>
                <tr>
                    <td><span id="toggleExpandedAll"><img class="toggleAll" id="toggleExpandedAllImage" src="dotnetimages/collapse.gif"> <label id=
                    "collapseAllLabel" style="DISPLAY: none" for="toggleExpandedAllImage">Collapse All</label> <label id="expandAllLabel" style="DISPLAY: none" for="toggleExpandedAllImage">
                    Expand All</label></span> <span id="languageFilterToolTip"
                    onmouseover='document.getElementById("languageFilterImage").src=document.getElementById("dropDownHoverImage").src;' style="CURSOR: default"
                    onfocusout='document.getElementById("languageFilterImage").src=document.getElementById("dropDownImage").src;' onclick=
                    "showBox('dxlanguagemenu',event,document.getElementById('languageFilterImage'))" onfocusin=
                    'document.getElementById("languageFilterImage").src=document.getElementById("dropDownHoverImage").src;' onmouseout=
                    'document.getElementById("languageFilterImage").src=document.getElementById("dropDownImage").src;'><img id="languageFilterImage" src=
                    "dotnetimages/drpdown.gif"> <label id="showAllLabel" style="DISPLAY: none" for="languageFilterImage">
                    Language Filter: All</label> <label id="multipleLabel" style=
                    "DISPLAY: none" for="languageFilterImage">Language Filter: Multiple</label> 
                    
<label id="VBLabel" for="languageFilterImage" style="display: none;">Language Filter: Visual Basic (Declaration)</label>
<label id="VBUsageLabel" for="languageFilterImage" style="display: none;">Language Filter: Visual Basic (Usage)</label>
<label id="CSLabel" for="languageFilterImage" style="display: none;">Language Filter: C#</label>
<label id="CPP2005Label" for="languageFilterImage" style="display: none;">Language Filter: C++/CLI</label>
</span></td>
                </tr>
            </tbody>
        </table><table width="100%" id="pagetopbreadcrumbs" cellspacing="0" cellpadding="0"><tr><td>
<a href="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks_namespace.html">SolidWorks.Interop.sldworks Namespace</a>
 : IGtolFrame Interface</td></tr></table>

        <div class="dxpopupbubble" id="dxlanguagemenu">
            
<input id="VBCheckbox" type="checkbox" name="languageFilter" onClick="setLanguage(this)" />
<label class="languageFilter" for="VBCheckbox">
Visual Basic (Declaration)
</label>
<br /><input id="VBUsageCheckbox" type="checkbox" name="languageFilter" onClick="setLanguage(this)" />
<label class="languageFilter" for="VBUsageCheckbox">
Visual Basic (Usage)
</label>
<br /><input id="CSCheckbox" type="checkbox" name="languageFilter" onClick="setLanguage(this)" />
<label class="languageFilter" for="CSCheckbox">
C#
</label>
<br /><input id="CPP2005Checkbox" type="checkbox" name="languageFilter" onClick="setLanguage(this)" />
<label class="languageFilter" for="CPP2005Checkbox">
C++/CLI
</label>

        </div>
    </div>

    <div id="pagebody" valign="bottom">
        <a name="topBookmark"></a>

        <div id="mainbody">
            <div class="saveHistory" id="allHistory" onsave="saveAll()" onload="loadAll()"></div>
             Allows access to&nbsp;indicators and XML strings for symbols in a&nbsp;Gtol feature control frame. 
            <br></br> 
            <p><b>NOTE:</b> Click the <b>Members</b> link, located near the top of the topic, to see this interface's methods and properties.</p><h1 class="heading"><span class="expandcollapse" tabindex="0"><img id="syntaxToggle" class="toggle" name="toggleSwitch" src="dotnetimages/collapse.gif"></img>.NET Syntax</span></h1><div id="syntaxSection" class="section" name="collapseableSection"><DIV class=LanguageSpecific id=Syntax_VB><table class="syntaxtable" width="100%" cellpadding="0" cellspacing="0"><tr><th>Visual Basic (Declaration)</th><th>&nbsp;</th></tr><tr><td colspan="2"><pre>Public Interface IGtolFrame </pre></tr></table></div>
<DIV class=LanguageSpecific id=Syntax_VBUsage><table class="syntaxtable" width="100%" cellpadding="0" cellspacing="0"><tr><th>Visual Basic (Usage)</th><th><span class="copyCode" onclick="copyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="changeCopyCodeIcon(this,true)" onfocusin="changeCopyCodeIcon(this,true)" onmouseout="changeCopyCodeIcon(this,false)" onfocusout="changeCopyCodeIcon(this,false)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="dotnetimages/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>Dim instance As <a href="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IGtolFrame.html">IGtolFrame</a></pre></tr></table></div>
<DIV class=LanguageSpecific id=Syntax_CS><table class="syntaxtable" width="100%" cellpadding="0" cellspacing="0"><tr><th>C#</th><th>&nbsp;</th></tr><tr><td colspan="2"><pre>public interface IGtolFrame </pre></tr></table></div>
<DIV class=LanguageSpecific id=Syntax_CPP2005><table class="syntaxtable" width="100%" cellpadding="0" cellspacing="0"><tr><th>C++/CLI</th><th>&nbsp;</th></tr><tr><td colspan="2"><pre>public interface class IGtolFrame </pre></tr></table></div>
</div>
            <h1 class="heading"><span class="expandcollapse" tabindex="0"><img id="visualbasic6syntaxToggle" class="toggle" name="toggleSwitch" src="dotnetimages/collapse.gif"></img>Visual Basic for Applications (VBA) Syntax</span></h1><div id="visualbasic6syntaxSection" class="section" name="collapseableSection">See <A href="ms-its:sldworksapivb6.chm::/sldworks~GtolFrame.html">GtolFrame</A>.</div> 
             <a name="exampleBookmark"></a>
            <h1 class="heading"><span class="expandcollapse" tabindex="0"><img id="exampleToggle" class="toggle" name="toggleSwitch" src="dotnetimages/collapse.gif"></img>Example</span></h1><div id="exampleSection" class="section" name="collapseableSection"><P>'VBA<BR>'====================================================<BR>'Preconditions:<BR>'1. Open a drawing that contains a GTol created with either SolidWorks 2021 or SolidWorks 2022/2022+.<BR>'2. Open an Immediate window.<BR>'<BR>'Postconditions:<BR>'1. Select a Gtol in the graphics area.<BR>'&nbsp;&nbsp; A Geometric Tolerance PropertyManager opens.<BR>'2. Click on the macro window and press F5.<BR>'3. Gtol format type and schema version print to the Immediate window.<BR>'4. Press F5.<BR>'5. The frame XML schema string prints to the Immediate window.<BR>'6. Press F5.<BR>'7. If the selected Gtol can be converted from 2021, it is attempted.<BR>'8. Inspect the Immediate window.<BR>'9. Press F5.<BR>'10. Gets and sets From and To text and toggles SEPARATE REQUIREMENT.<BR>'11. Inspect the Immediate window.<BR>'12. Press F5.<BR>'13. Gtol frames added and deleted.<BR>'14. Inspect the Immediate window.<BR>'15. Press F5.<BR>'16. Add Indicator tests.<BR>'17. Inspect the Immediate window.<BR>'18. Press F5.<BR>'19. Get Indicator tests.<BR>'20. Inspect the Immediate window.<BR>'21. Press F5.<BR>'22. Delete Indicator tests.<BR>'23. Inspect the Immediate window.<BR>'24. Press F5.<BR>'25. Miscellaneous Indicator tests.<BR>'26. Inspect the Immediate window.<BR>'27. Press F5.<BR>'28. Tolerance type tests.<BR>'29. Inspect the Immediate window.<BR>'30. Press F5.<BR>'31. Get and set symbol XML string.<BR>'32. Inspect the Immediate window.<BR>'====================================================<BR>Dim swApp As SldWorks.SldWorks<BR>Dim swModel As SldWorks.ModelDoc2<BR>Dim boolstatus As Boolean<BR>Dim longstatus As Long, longwarnings As Long<BR>Dim swSelMgr As SldWorks.SelectionMgr<BR>Dim swGtol As SldWorks.Gtol<BR>Dim swGtolFrame As SldWorks.GtolFrame<BR>Dim swGtolFrame1 As SldWorks.GtolFrame<BR>Dim FrameCount As Long<BR>Dim sXMLString As String<BR>Dim iIndicator As Long<BR>Dim iFrame As Long<BR>Dim lFormatType As Long<BR>Dim lFormatType1 As Long<BR>Dim lSchemaVersion As Long<BR>Dim sSchemaString As String<BR>Dim swConversionError As SwConst.swGtolFormatConversionError_e<BR>Dim swFromText As String<BR>Dim swToText As String<BR>Dim swFromText1 As String<BR>Dim swToText1 As String<BR>Dim IndicatorCount As Long<BR>Dim sDatum As String<BR>Dim lBorderType As SwConst.swGtolIndicatorBorderType_e<BR>Dim lTolType As SwConst.swGtolGeomCharSymbol_e<BR>Dim swToleranceType As SwConst.swGtolGeomCharSymbol_e<BR>Dim swTolType As Long<BR>Dim pos As Long</P>
<P>Option Explicit</P>
<P>Sub main()</P>
<P>&nbsp;&nbsp;&nbsp; Set swApp = Application.SldWorks<BR>&nbsp;&nbsp;&nbsp; Set swModel = swApp.ActiveDoc<BR>&nbsp;&nbsp;&nbsp; Set swSelMgr = swModel.SelectionManager<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; Stop 'in the graphics area select Gtol created with either SolidWorks 2021 or SolidWorks 2022/2022+<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; Debug.Print "Select object type as defined by swSelectType_e: " &amp; swSelMgr.GetSelectedObjectType3(1, -1)<BR>&nbsp;&nbsp;&nbsp; Set swGtol = swSelMgr.GetSelectedObject6(1, -1)<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; swApp.<STRONG>GetGtolFormatData</STRONG> lFormatType, lSchemaVersion<BR>&nbsp;&nbsp;&nbsp; Debug.Print "Gtol format type as defined by swGtolFormatType_e: " &amp; lFormatType<BR>&nbsp;&nbsp;&nbsp; Debug.Print "Gtol schema version as defined by swGtolFormatSchemaVersion_e: " &amp; lSchemaVersion<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; Stop</P>
<P>&nbsp;&nbsp;&nbsp; sSchemaString = swApp.<STRONG>GetGtolFrameXMLSchema</STRONG><BR>&nbsp;&nbsp;&nbsp; Debug.Print "Gtol frame XML schema: " &amp; sSchemaString<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; Stop<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; boolstatus = swGtol.<STRONG>CanConvertFormat</STRONG><BR>&nbsp;&nbsp;&nbsp; If Not boolstatus = 0 Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lFormatType1 = swGtol.<STRONG>GetFormat</STRONG><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If lFormatType1 = SwConst.swGtolFormatType_e.GTOL_SW2021 Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; boolstatus = swModel.GetSaveFlag<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If boolstatus &lt;&gt; 0 Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; swModel.Save<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print "SaveFlag BEFORE ConvertFormat is called " &amp; swModel.GetSaveFlag<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; swConversionError = swGtol.<STRONG>ConvertFormat</STRONG><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; boolstatus = swModel.GetSaveFlag 'if successful, converted Gtol document should be dirty and return True<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print "SaveFlag AFTER ConvertFormat is called " &amp; boolstatus<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lFormatType1 = swGtol.<STRONG>GetFormat</STRONG> 'converted from 2021 to 2022<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<BR>&nbsp;&nbsp;&nbsp; End If<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; Stop<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; boolstatus = swGtol.<STRONG>GetFromTo</STRONG><BR>&nbsp;&nbsp;&nbsp; boolstatus = swGtol.<STRONG>GetFromToText</STRONG>(swFromText, swToText)<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; swFromText = "FromMe"<BR>&nbsp;&nbsp;&nbsp; swToText = "ToYou"<BR>&nbsp;&nbsp;&nbsp; boolstatus = swGtol.<STRONG>SetFromToText</STRONG>(True, swFromText, swToText)<BR>&nbsp;&nbsp;&nbsp; boolstatus = swGtol.<STRONG>GetFromTo</STRONG><BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; swFromText1 = ""</P>
<P>&nbsp;&nbsp;&nbsp; swToText1 = ""<BR>&nbsp;&nbsp;&nbsp; boolstatus = swGtol.<STRONG>GetFromToText</STRONG>(swFromText1, swToText1) 'should be "FromMe" and "ToMe"<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; Debug.Print "From text: " &amp; swFromText1<BR>&nbsp;&nbsp;&nbsp; Debug.Print "To text: " &amp; swToText1<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; boolstatus = swGtol.<STRONG>SeparateRequirement</STRONG><BR>&nbsp;&nbsp;&nbsp; If Not boolstatus = 0 Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; swGtol.<STRONG>SeparateRequirement</STRONG> = False<BR>&nbsp;&nbsp;&nbsp; Else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; swGtol.<STRONG>SeparateRequirement</STRONG> = True<BR>&nbsp;&nbsp;&nbsp; End If<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; Debug.Print "SEPARATE REQUIREMENT ? " &amp; swGtol.<STRONG>SeparateRequirement</STRONG><BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; Stop<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; FrameCount = swGtol.<STRONG>GetFrameCount</STRONG><BR>&nbsp;&nbsp;&nbsp; Debug.Print "Frame count: " &amp; FrameCount<BR>&nbsp;&nbsp;&nbsp; boolstatus = swGtol.<STRONG>AddFrame</STRONG><BR>&nbsp;&nbsp;&nbsp; FrameCount = swGtol.<STRONG>GetFrameCount</STRONG> 'frame count should increase by one<BR>&nbsp;&nbsp;&nbsp; Debug.Print "Frame added. Frame count now: " &amp; FrameCount<BR>&nbsp;&nbsp;&nbsp; boolstatus = swGtol.<STRONG>DeleteFrame</STRONG>(FrameCount)<BR>&nbsp;&nbsp;&nbsp; FrameCount = swGtol.<STRONG>GetFrameCount</STRONG> 'frame count should decrease by 1, as just added frame was deleted<BR>&nbsp;&nbsp;&nbsp; Debug.Print "Frame deleted. Frame count now: " &amp; FrameCount<BR>&nbsp;&nbsp;&nbsp; boolstatus = swGtol.<STRONG>AddFrame</STRONG><BR>&nbsp;&nbsp;&nbsp; FrameCount = swGtol.<STRONG>GetFrameCount</STRONG> 'frame count should increase by 1<BR>&nbsp;&nbsp;&nbsp; Debug.Print "Frame added. Frame count now: " &amp; FrameCount<BR>&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp; Stop<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; Set swGtolFrame = swGtol.<STRONG>GetFrame</STRONG>(FrameCount)<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; IndicatorCount = swGtolFrame.<STRONG>GetIndicatorCount</STRONG><BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; sDatum = "A"<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; Debug.Print " "<BR>&nbsp;&nbsp;&nbsp; Debug.Print "Frame " &amp; FrameCount &amp; " IndicatorCount is " &amp; IndicatorCount &amp; ": AddIndicator test"<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; 'supported border types: swGtolIndicatorBorderType_CollectionPlane, swGtolIndicatorBorderType_OrientationPlane swGtolIndicatorBorderType_IntersectionPlane swGtolIndicatorBorderType_DirectionFeature<BR>&nbsp;&nbsp;&nbsp; 'supported tolerance types: swGcsPARALLEL swGcsPERP swGcsANG swGcsCIRCRUNOUT swGcsSYMMETRY</P>
<P><BR>&nbsp;&nbsp;&nbsp; boolstatus = swGtolFrame.<STRONG>AddIndicator</STRONG>(SwConst.swGtolIndicatorBorderType_e.swGtolIndicatorBorderType_IntersectionPlane, SwConst.swGtolGeomCharSymbol_e.swGcsFLAT, sDatum) 'unsupported TolType<BR>&nbsp;&nbsp;&nbsp; Debug.Print "Unsupported TolType swGcsFLAT. AddIndicator return value is " &amp; boolstatus<BR>&nbsp;&nbsp;&nbsp; boolstatus = swGtolFrame.<STRONG>AddIndicator</STRONG>(SwConst.swGtolGeomCharSymbol_e.swGcsFLAT, SwConst.swGtolGeomCharSymbol_e.swGcsSYMMETRY, sDatum) 'unsupported BorderType<BR>&nbsp;&nbsp;&nbsp; Debug.Print "Unsupported BorderType swGcsFLAT. AddIndicator return value is " &amp; boolstatus<BR>&nbsp;&nbsp;&nbsp; boolstatus = swGtolFrame.<STRONG>AddIndicator</STRONG>(SwConst.swGtolIndicatorBorderType_e.swGtolIndicatorBorderType_IntersectionPlane, SwConst.swGtolGeomCharSymbol_e.swGcsSYMMETRY, sDatum) 'supported BorderType and TolType<BR>&nbsp;&nbsp;&nbsp; Debug.Print "Supported BorderType swGtolIndicatorBorderType_IntersectionPlane and TolType swGcsSYMMETRY. AddIndicator return value is " &amp; boolstatus<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; IndicatorCount = swGtolFrame.<STRONG>GetIndicatorCount</STRONG><BR>&nbsp;&nbsp;&nbsp; Debug.Print ""<BR>&nbsp;&nbsp;&nbsp; Debug.Print "Frame " &amp; FrameCount &amp; " IndicatorCount after one successful AddIndicator is " &amp; IndicatorCount 'should increase by 1 from AddIndicator success<BR>&nbsp;&nbsp;&nbsp; Debug.Print " "<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; Stop<BR>&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; IndicatorCount = swGtolFrame.<STRONG>GetIndicatorCount</STRONG><BR>&nbsp;&nbsp;&nbsp; iIndicator = 0<BR>&nbsp;&nbsp;&nbsp; iFrame = 0<BR>&nbsp;&nbsp;&nbsp; FrameCount = swGtol.<STRONG>GetFrameCount</STRONG><BR>&nbsp;&nbsp;&nbsp; Debug.Print "FrameCount is " &amp; FrameCount &amp; ": GetIndicator test"<BR>&nbsp;&nbsp;&nbsp; For iFrame = 1 To FrameCount<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lBorderType = -1<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lTolType = -1<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sDatum = ""<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set swGtolFrame1 = swGtol.<STRONG>GetFrame</STRONG>(iFrame)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For iIndicator = 1 To IndicatorCount<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; boolstatus = swGtolFrame1.<STRONG>GetIndicator</STRONG>(iIndicator, lBorderType, lTolType, sDatum)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print "Frame: " &amp; iFrame &amp; " Indicator index: " &amp; iIndicator &amp; " (BorderType as defined by swGtolIndicatorBorderType_e&nbsp; = " &amp; lBorderType &amp; " " &amp; "TolType as defined by swGtolGeomCharSymbol_e = " &amp; lTolType &amp; " " &amp; "Datum = " &amp; sDatum &amp; ")"<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Next<BR>&nbsp;&nbsp;&nbsp; Next<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; Debug.Print " "<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; Stop<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; Debug.Print "Frame " &amp; FrameCount &amp; " DeleteIndicator test"<BR>&nbsp;&nbsp;&nbsp; boolstatus = swGtolFrame.<STRONG>DeleteIndicator</STRONG>(IndicatorCount)<BR>&nbsp;&nbsp;&nbsp; Debug.Print "DeleteIndicator return value is " &amp; boolstatus<BR>&nbsp;&nbsp;&nbsp; IndicatorCount = swGtolFrame.<STRONG>GetIndicatorCount</STRONG> 'should decrease by 1, as indicator deleted<BR>&nbsp;&nbsp;&nbsp; Debug.Print "IndicatorCount is " &amp; IndicatorCount &amp; " after DeleteIndicator"<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; Stop<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; Debug.Print " "<BR>&nbsp;&nbsp;&nbsp; Debug.Print "Miscellaneous Indicator test:"<BR>&nbsp;&nbsp;&nbsp; boolstatus = swGtolFrame.<STRONG>AddIndicator</STRONG>(SwConst.swGtolIndicatorBorderType_e.swGtolIndicatorBorderType_OrientationPlane, SwConst.swGtolGeomCharSymbol_e.swGcsANG, sDatum) 'add indicator for different BorderType and TolType<BR>&nbsp;&nbsp;&nbsp; Debug.Print "Supported swGtolIndicatorBorderType_OrientationPlane BorderType AddIndicator return value is " &amp; boolstatus<BR>&nbsp;&nbsp;&nbsp; IndicatorCount = swGtolFrame.<STRONG>GetIndicatorCount</STRONG> 'should increase by 1<BR>&nbsp;&nbsp;&nbsp; Debug.Print "Frame " &amp; FrameCount &amp; " IndicatorCount after one successful AddIndicator is " &amp; IndicatorCount 'should increase by 1<BR>&nbsp;&nbsp;&nbsp; boolstatus = swGtolFrame.<STRONG>GetIndicator</STRONG>(IndicatorCount, lBorderType, lTolType, sDatum)<BR>&nbsp;&nbsp;&nbsp; Debug.Print "Frame " &amp; FrameCount &amp; " just added GetIndicator: " &amp; " (BorderType = " &amp; lBorderType &amp; " " &amp; "TolType = " &amp; lTolType &amp; " " &amp; "Datum = " &amp; sDatum &amp; ")"<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; If Not sDatum = "B" Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sDatum = "B"<BR>&nbsp;&nbsp;&nbsp; Else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sDatum = "A"<BR>&nbsp;&nbsp;&nbsp; End If<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; boolstatus = swGtolFrame.<STRONG>SetIndicator</STRONG>(IndicatorCount, SwConst.swGtolIndicatorBorderType_e.swGtolIndicatorBorderType_IntersectionPlane, SwConst.swGtolGeomCharSymbol_e.swGcsPERP, sDatum)<BR>&nbsp;&nbsp;&nbsp; Debug.Print "Indicator " &amp; IndicatorCount &amp; " SetIndicator return value is " &amp; boolstatus<BR>&nbsp;&nbsp;&nbsp; boolstatus = swGtolFrame.<STRONG>GetIndicator</STRONG>(IndicatorCount, SwConst.swGtolIndicatorBorderType_e.swGtolIndicatorBorderType_IntersectionPlane, SwConst.swGtolGeomCharSymbol_e.swGcsFLAT, sDatum)<BR>&nbsp;&nbsp;&nbsp; Debug.Print "Indicator " &amp; IndicatorCount &amp; " SetIndicator values " &amp; " (BorderType = " &amp; lBorderType &amp; " " &amp; "TolType = " &amp; lTolType &amp; " " &amp; "Datum = " &amp; sDatum &amp; ")"<BR>&nbsp;&nbsp;&nbsp; Debug.Print " "<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; Stop<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; Set swGtolFrame = swGtol.<STRONG>GetFrame</STRONG>(swGtol.GetFrameCount)<BR>&nbsp;&nbsp;&nbsp; Debug.Print "Frame " &amp; 2 &amp; " ToleranceType test"<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; boolstatus = swGtolFrame.<STRONG>GetFrameToleranceType</STRONG>(swToleranceType)<BR>&nbsp;&nbsp;&nbsp; Debug.Print "GetFrameToleranceType " &amp; "returned " &amp; boolstatus<BR>&nbsp;&nbsp;&nbsp; Debug.Print "GetFrameToleranceType " &amp; "before set returned tolerance type as defined by swGtolGeomCharSymbol_e: " &amp; swToleranceType<BR>&nbsp;&nbsp;&nbsp; boolstatus = swGtolFrame.<STRONG>SetFrameToleranceType</STRONG>(SwConst.swGtolGeomCharSymbol_e.swGcsROUND)<BR>&nbsp;&nbsp;&nbsp; Debug.Print "SetFrameToleranceType " &amp; "returned " &amp; boolstatus<BR>&nbsp;&nbsp;&nbsp; boolstatus = swGtolFrame.<STRONG>GetFrameToleranceType</STRONG>(swTolType)<BR>&nbsp;&nbsp;&nbsp; Debug.Print "GetFrameToleranceType " &amp; "returned " &amp; boolstatus<BR>&nbsp;&nbsp;&nbsp; Debug.Print "GetFrameToleranceType " &amp; "after set returned tolerance type as defined by swGtolGeomCharSymbol_e: " &amp; swTolType<BR>&nbsp;&nbsp;&nbsp; Debug.Print ""<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; Stop<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; sXMLString = swGtolFrame.<STRONG>GetSymbolXml</STRONG><BR>&nbsp;&nbsp;&nbsp; Debug.Print "Symbol XML string: " &amp; sXMLString<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; 'Set a new symbol XML string of last added frame<BR>&nbsp;&nbsp;&nbsp; pos = -1<BR>&nbsp;&nbsp;&nbsp; pos = InStr(1, sXMLString, ".01") 'Note: converted Gtol has tolerance format of .01, not 0.01<BR>&nbsp;&nbsp;&nbsp; If Not pos = -1 Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sXMLString = Replace(sXMLString, ".01", ".02")<BR>&nbsp;&nbsp;&nbsp; Else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pos = InStr(1, sXMLString, ".02")<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Not pos = -1 Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sXMLString = Replace(sXMLString, ".02", ".01")<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<BR>&nbsp;&nbsp;&nbsp; End If<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; boolstatus = swGtolFrame.<STRONG>SetSymbolXml</STRONG>(sXMLString)<BR>&nbsp;&nbsp;&nbsp; Debug.Print "New symbol XML string: " &amp; sXMLString</P>
<P>End Sub</P> 
            </div> 
            <h1 class="heading"><span class="expandcollapse" tabindex="0"><img id="exampleToggle" class="toggle" name="toggleSwitch" src="dotnetimages/collapse.gif"></img>Example</span></h1><div id="exampleSection" class="section" name="collapseableSection"><a href="Get_Gtol_Frame_Information_Example_VBNET.htm">Get Gtol Frame Information (VB.NET)</a>
<br/><a href="Get_Gtol_Frame_Information_Example_CSharp.htm">Get Gtol Frame Information (C#)</a>
</div>
            <h1 class="heading"><span class="expandcollapse" tabindex="0"><img id="remarksToggle" class="toggle" name="toggleSwitch" src="dotnetimages/collapse.gif"></img>Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection"><P>A geometric tolerance symbol adds geometric tolerances to parts and drawings using feature control frames.</P>
<P>This interface extends&nbsp;<A href="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IGtol.html">IGtol</A> by supporting the new&nbsp;SOLIDWORKS 2022 Gtol architecture and providing the ability to specify Gtol frames using XML:</P>
<UL>
<LI>Left of Gtol you can add a single line of text and symbol (first frame only). 
<LI>Above Gtol you can add multi-line text and symbol (top frame only). 
<LI>Right of Gtol there can be indicator, datum, or text box. Multiple indicators are supported, but any text box must be at the end of the list of indicators. Text box can have only one line and symbol. 
<LI>Below Gtol there can be additional frames, text, between instruction, from-to instruction, separate requirement label (bottom frame only).</LI></UL>
<P>For more information, see the <STRONG>SOLIDWORKS user-interface help &gt; Detailing and Drawings &gt; Annotations &gt; Symbols &gt; Geometric Tolerance Symbols</STRONG> topic.</P></div>
            <h1 class="heading"><span class="expandcollapse" tabindex="0"><img id="accessorsToggle" class="toggle" name="toggleSwitch" src="dotnetimages/collapse.gif"></img>Accessors</span></h1><div id="accessorsSection" class="section" name="collapseableSection"><A href="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IGtol~GetFrame.html">IGtol::GetFrame</A></div>
			<h1 class="heading"><span class="expandcollapse" tabindex="0"><img id="swobjectmodelToggle" class="toggle" name="toggleSwitch" src="dotnetimages/collapse.gif"></img>Access Diagram</span></h1><div id="swobjectmodelSection" class="section" name="collapseableSection"><P><A href="SWObjectModel.pdf#GtolFrame" data-build-flags="6203F2EA-8EE3-42D1-BCE6-173894689876">GtolFrame</A></P>
<P></P></div>
            
            <a name="seealsobookmark"></a>
            <h1 class="heading"><span class="expandcollapse" tabindex="0"><img id="seealsoToggle" class="toggle" name="toggleSwitch" src="dotnetimages/collapse.gif"></img>See Also</span></h1><div id="seealsoSection" class="section" name="collapseableSection"><h4 class="dxh4"></h4><a href="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IGtolFrame_members.html">IGtolFrame Members</a>
<br/><a href="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks_namespace.html">SolidWorks.Interop.sldworks Namespace</a>
</p>
</div>
        </div>

        <div id="pagefooter"></div>
    </div>
</body>
</html>