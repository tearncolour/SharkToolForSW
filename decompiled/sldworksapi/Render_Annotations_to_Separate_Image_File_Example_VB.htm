<html>

<head>
<title>Render Annotations to Separate Image File Example (VBA)</title>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<link rel="stylesheet" type="text/css" href="ApiHelp.css">
</head>
<meta name=MS-HKWD content="VBA examples,render">
<meta name=MS-HKWD content="VBA examples,notes">
<meta name=MS-HKWD content="VBA examples,annotations">
<meta name=MS-HKWD content="VBA examples,dimensions">
<body>
<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API 
 Help</span></h1>
<h1>Render Annotations to Separate Image File Example (VBA)</h1>
<p>This example shows how to render annotations and dimensions visible in a 
model to a separate image file.</p>

<pre>'--------------------------------------------------------------
' Preconditions:
' 1. Open a model document.
' 2. Add a note to the model.
' 3. Right-click <b>Annotations</b> in the FeatureManager design tree
'    and click <b>Show Feature Dimensions</b>, if dimensions
'    are not visible in the model.
' 4. Verify that:
'    * a ray-trace rendering engine is loaded.
'    * <b>c:\temp</b> exists.
'
' Preconditions:
' 1. Sets the options to include and render annotations and dimensions  
'    visible in a model to a separate image file.
' 2. If prompted to add camera or perspective, click <b>Continue</b>
'    <b>without Camera or Perspective</b>.
' 3. Renders:
'    * model to <b>c:\temp\annotations.png</b>
'    * note and dimensions to <b>c:\temp\annotations_1.png</b>
' 4. Open both files to verify the previous step.
'--------------------------------------------------------------
Option Explicit

Sub main()

        Dim swApp As SldWorks.SldWorks
        Dim swModel As SldWorks.ModelDoc2
        Dim swRayTraceRenderer As SldWorks.RayTraceRenderer
        Dim swRayTraceRenderOptions As SldWorks.RayTraceRendererOptions
        Dim status As Boolean

        Set swApp = Application.SldWorks
        Set swModel = swApp.<b>ActiveDoc</b>        </pre>
<pre>        'Access ray-trace rendering engine
       'Set swRayTraceRenderer = swApp.<b>GetRayTraceRenderer</b>()        </pre>
<pre>        'Set options to include and render annotations and dimensions  
	'visible in a model to a separate image file
        Set swRayTraceRenderOptions = swRayTraceRenderer.<b>RayTraceRendererOptions</b>
	swRayTraceRenderOptions.<b>IncludeAnnotationsInRendering</b> = True
        swRayTraceRenderOptions.<b>RenderAnnotationsToSeparateImage</b> = True
        status = swRayTraceRenderer.<b>RenderToFile</b>(&quot;c:\temp\annotations.png&quot;, 0, 0)
        status = swRayTraceRenderer.<b>CloseFinalRenderWindow
</b>
End Sub</pre>

<p>&nbsp;</p>

</body>

</html>
