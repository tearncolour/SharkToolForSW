# 8. 安装与部署

## 8.1 开发环境要求

- Windows 10/11 64位
- SolidWorks 2020 或更高版本
- Visual Studio 2019/2022（含 .NET Framework 4.7.2）
- Node.js 18+
- Git

## 8.2 插件安装

**方法一：PowerShell 脚本（推荐）**

```powershell
# 管理员权限运行
powershell -ExecutionPolicy Bypass -File install_sharktools.ps1

# 指定配置
powershell -ExecutionPolicy Bypass -File install_sharktools.ps1 -Configuration Release

# 指定 SolidWorks 路径
powershell -ExecutionPolicy Bypass -File install_sharktools.ps1 -SolidWorksInstallDir "D:\SOLIDWORKS"
```

**方法二：手动注册**

```cmd
# 编译项目
dotnet build -c Release

# 使用 RegAsm 注册
C:\Windows\Microsoft.NET\Framework\v4.0.30319\RegAsm.exe ^
    "bin\x64\Release\net472\SharkTools.dll" /codebase /tlb
```

## 8.3 客户端安装

**开发模式**：
```bash
cd electron-app
npm install
npm run dev
```

**生产构建**：
```bash
npm run build
```

**打包安装程序**：
```bash
npm run pack
```

## 8.4 启用插件

1. 打开 SolidWorks
2. 菜单: 工具 -> 加载项
3. 勾选 "SharkTools"
4. 勾选 "启动时加载" 以自动加载